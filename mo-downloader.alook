{
  "match": 0,
  "info": "mo\u4e0b\u8f7d\u5668",
  "regex": "m.tribe-m.jp@@m.ex-m.jp@@m.ldh-m.jp@@m.ldhgirls-m.jp",
  "runat": 0,
  "version": "0.36",
  "author": "\u4e59\u919a",
  "name": "mo\u4e0b\u8f7d\u5668",
  "code": "Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgICAgbW8gKExESCkg5LiL6L295ZmoCi8vIEBuYW1lc3BhY2UgICAgICAgICAgIGh0dHBzOi8vMW1ldGhlci5tZS8KLy8gQHZlcnNpb24gICAgICAgICAgICAgMC4zNgovLyBAZGVzY3JpcHRpb24gICAgICAgICDlnKhtb+eahOWGheWuuemhteWinuWKoOWbvueJh+WSjOinhumikeS4i+i9veeahOaMiemSru+8jCDop6PplIHlj7PplK7lip/og70KLy8gQGF1dGhvciAgICAgICAgICAgICAg5LmZ6YaaKEBsb2NvZGEpCi8vIEBtYXRjaCAgICAgICAgICAgICAgIGh0dHAqOi8vbS50cmliZS1tLmpwLyoKLy8gQG1hdGNoICAgICAgICAgICAgICAgaHR0cCo6Ly9tLmV4LW0uanAvKgovLyBAbWF0Y2ggICAgICAgICAgICAgICBodHRwKjovL20ubGRoLW0uanAvKgovLyBAbWF0Y2ggICAgICAgICAgICAgICBodHRwKjovL20ubGRoZ2lybHMtbS5qcC8qCi8vIEBtYXRjaCAgICAgICAgICAgICAgIGh0dHAqOi8vaWQuZXhmYW1pbHkuanAvcy9sZGgvKgovLyBAaWNvbiAgICAgICAgICAgICAgICBodHRwczovL3d3dy5nb29nbGUuY29tL3MyL2Zhdmljb25zP3N6PTY0JmRvbWFpbj1sZGguY28uanAKLy8gQHNvdXJjZSAgICAgICAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2xvY29kYS9tby1kb3dubG9hZGVyCi8vIEBsaWNlbnNlICAgICAgICAgICAgIE1JVAovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbiAoKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICAvLyA9PT09PT09PT09PT09PT09CiAgICAvLyA9ICAgIENvbnN0cyAgICA9CiAgICAvLyA9PT09PT09PT09PT09PT09CgogICAgY29uc3QgaXNNb2JpbGUgPSAoKSA9PgogICAgICAgIC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdCgKICAgICAgICAgICAgbmF2aWdhdG9yLnVzZXJBZ2VudAogICAgICAgICk7CgogICAgY29uc3Qga2V5d29yZHMgPSBbInVwbGNtbiIsICJ1cGxvYWQiXTsKCiAgICAvLyA9PT09PT09PT09PT09PQogICAgLy8gPSAgICBNYWluICAgID0KICAgIC8vID09PT09PT09PT09PT09CgogICAgLy8gTW8g5LiL6L295Zu+54mHCiAgICBpZiAod2luZG93LmxvY2F0aW9uLmhvc3QuaW5jbHVkZXMoIi1tLmpwIikpIHsKICAgICAgICAvLyDliKDpmaTlm77niYfkv53miqQKICAgICAgICByZW1vdmVQcm90ZWN0SW1nKCk7CiAgICAgICAgLy8g5Zyo6K+m5oOF6aG15rOo5YWl5oyJ6ZKuCiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmNsdWRlcygiZGV0YWlsIikpIHsKICAgICAgICAgICAgaW5qZWN0RG93bmxvYWRBbGxCdXR0b25zKCk7CiAgICAgICAgfQogICAgICAgIC8vIOWcqOinhumikemhtemdouazqOWFpeaMiemSrgogICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoIm1vdmllIikpIHsKICAgICAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImRpdi5saW1lbGlnaHQtcGxheWVyIikpIHsKICAgICAgICAgICAgICAgIGluamVjdFBlclZpZGVvRG93bmxvYWRCdXR0b24oZG9jdW1lbnQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIOWcqOaXtumXtOi9tOeVjOmdouWIneWni+WMluW5tuiuvue9rkxpc3RlbmVyCiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmNsdWRlcygidGltZWxpbmUiKSkgewogICAgICAgICAgICAvLyDnrYnlvoXliqDovb1zY3JvbGwKICAgICAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImxkaC1pbmZpbml0ZS1zY3JvbGwiKTsKICAgICAgICAgICAgICAgIGlmIChjb3VudGVyKSB7CiAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5oyJ6ZKu5ZKM55uR5ZCsCiAgICAgICAgICAgICAgICAgICAgY3VzdG9taXplZFRpbWVsaW5lUGFnZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGluaXQsIDMwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKCk7CiAgICAgICAgfQogICAgICAgIC8vIOWcqEHlhpnpobXpnaLms6jlhaXmjInpkq4KICAgICAgICBpZiAoCiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmNsdWRlcygiYXJ0aXN0cGhvdG8iKSB8fAogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoImFydGlzdF9waG90byIpCiAgICAgICAgKSB7CiAgICAgICAgICAgIOWcqGluamVjdEFydGlzdFBob3RvRG93bmxvYWRCdXR0b24oKTsKICAgICAgICB9CiAgICAgICAgLy8gT2Zmc2hvdOmhtemdouazqOWFpeaMiemSrgogICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoImxkaF9vZmZfc2hvdCIpKSB7CiAgICAgICAgICAgIGluamVjdE9mZnNob3REb3dubG9hZEJ1dHRvbigpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBGQyDkuIvovb3lm77niYcKICAgIGlmICh3aW5kb3cubG9jYXRpb24uaG9zdC5pbmNsdWRlcygiZXhmYW1pbHkuanAiKSkgewogICAgICAgIC8vIEZDIE1hZ2F6aW5lIOS4i+i9veWbvueJhwogICAgICAgIGluamVjdEZDTWFnYXppbmVCdXR0b24oKTsKICAgIH0KCiAgICAvLyA9PT09PT09PT09PT09PT0KICAgIC8vID0gICAgVXRpbHMgICAgPQogICAgLy8gPT09PT09PT09PT09PT09CgogICAgZnVuY3Rpb24gcmVtb3ZlUHJvdGVjdEltZygpIHsKICAgICAgICAvLyDnp7vpmaTlj7PplK7pmZDliLYKICAgICAgICBkb2N1bWVudC5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9OwogICAgICAgIC8vIOenu+mZpHByb3RlY3RpbWfpmZDliLYKICAgICAgICBkb2N1bWVudAogICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbCgiLnByb3RlY3RpbWciKQogICAgICAgICAgICAuZm9yRWFjaCgobm9kZSkgPT4gbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCJwcm90ZWN0aW1nIikpOwogICAgICAgIG1vRG93bmxvYWRlckxvZygi56e76Zmk5Y+z6ZSu6ZmQ5Yi2Iik7CiAgICB9CgogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vID0gICAgQnV0dG9uIEluamVjdGlvbiBVdGlscyAgICA9CiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIGZ1bmN0aW9uIGluamVjdERvd25sb2FkQWxsQnV0dG9ucygpIHsKICAgICAgICB2YXIgYXJ0aWNsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImFydGljbGUiKTsKICAgICAgICBpZiAoYXJ0aWNsZS5jbGFzc0xpc3QuY29udGFpbnMoImFydGljbGUtLW5ld3MiKSkgewogICAgICAgICAgICAvLyDmlrDpl7vpobXpnaLnibnmrorlpITnkIYKICAgICAgICAgICAgYXJ0aWNsZSA9IGFydGljbGUucXVlcnlTZWxlY3RvcigiLmFydGljbGVfX2JvZHkiKTsKICAgICAgICB9CiAgICAgICAgYXR0YWNoQnV0dG9uVG9BcnRpY2xlKGFydGljbGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmRFbGlnaWJsZUltZ3NGcm9tQXJ0aWNsZShhcnRpY2xlKSB7CiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oYXJ0aWNsZS5xdWVyeVNlbGVjdG9yQWxsKCJpbWciKSkKICAgICAgICAgICAgLm1hcCgoaW1nKSA9PiBpbWcuc3JjKQogICAgICAgICAgICAuZmlsdGVyKChpbWcpID0+IGtleXdvcmRzLnNvbWUoKGspID0+IGltZy5pbmNsdWRlcyhrKSkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGF0dGFjaEJ1dHRvblRvQXJ0aWNsZShhcnRpY2xlKSB7CiAgICAgICAgdmFyIGltZ3MgPSBmaW5kRWxpZ2libGVJbWdzRnJvbUFydGljbGUoYXJ0aWNsZSk7CiAgICAgICAgLy8g5rOo5YWl5oyJ6ZKuIGRpdgogICAgICAgIHZhciBidXR0b25zRGl2ID0gZ2V0QnV0dG9uRGl2KCk7CiAgICAgICAgYXJ0aWNsZS5pbnNlcnRCZWZvcmUoYnV0dG9uc0RpdiwgYXJ0aWNsZS5maXJzdENoaWxkKTsKICAgICAgICAvLyDlm77niYfpk77mjqXnlJ/miJDmjInpkq4KICAgICAgICBpZiAoaXNNb2JpbGUoKSkgewogICAgICAgICAgICBpbmplY3RPbmVCdXR0b24oCiAgICAgICAgICAgICAgICBidXR0b25zRGl2LAogICAgICAgICAgICAgICAgIueUn+aIkOWbvueJh+mTvuaOpSgiICsgaW1ncy5sZW5ndGggKyAiKSIsCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZ2VuZXJhdGVPbkNsaWNrSGFuZGxlcihidXR0b25zRGl2LCBpbWdzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDlm77niYfkuIvovb3mjInpkq4KICAgICAgICAgICAgaW5qZWN0T25lQnV0dG9uKAogICAgICAgICAgICAgICAgYnV0dG9uc0RpdiwKICAgICAgICAgICAgICAgICLkuIvovb3miYDmnInlm77niYcgKCIgKyBpbWdzLmxlbmd0aCArICIpIiwKICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZEltYWdlcygKICAgICAgICAgICAgICAgICAgICAgICAgZmluZEVsaWdpYmxlSW1nc0Zyb21BcnRpY2xlKGFydGljbGUpLAogICAgICAgICAgICAgICAgICAgICAgICBnZXRQcmVmaXhGcm9tQXJ0aWNsZShhcnRpY2xlKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIC8vIOinhumikeS4i+i9veaMiemSrgogICAgICAgIGlmICgKICAgICAgICAgICAgYXJ0aWNsZS5xdWVyeVNlbGVjdG9yKCJkaXYubGltZWxpZ2h0LXBsYXllciIpIHx8CiAgICAgICAgICAgIGFydGljbGUucXVlcnlTZWxlY3RvcigiYS5wb3B1cF9saW5rIikKICAgICAgICApIHsKICAgICAgICAgICAgLy8gTGlzdCBWaWV3IOinhumikQogICAgICAgICAgICBpbmplY3RQZXJWaWRlb0Rvd25sb2FkQnV0dG9uKGFydGljbGUpOwogICAgICAgICAgICAvLyBUaW1lbGluZSDop4bpopEKICAgICAgICAgICAgaW5qZWN0UGVyVmlkZW9Eb3dubG9hZEJ1dHRvbkZvclRpbWVsaW5lKGFydGljbGUpOwogICAgICAgIH0KICAgICAgICBtb0Rvd25sb2FkZXJMb2coIuazqOWFpeaMiemSriIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluamVjdFBlclZpZGVvRG93bmxvYWRCdXR0b24oZGl2KSB7CiAgICAgICAgZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoImRpdi5saW1lbGlnaHQtcGxheWVyIikuZm9yRWFjaCgodmlkZW9EaXYpID0+IHsKICAgICAgICAgICAgdmFyIG1lZGlhSWQgPSB2aWRlb0Rpdi5pZC5zdWJzdHJpbmcodmlkZW9EaXYuaWQubGFzdEluZGV4T2YoIl8iKSArIDEpOwogICAgICAgICAgICBtb0Rvd25sb2FkZXJEZWJ1Zygi5q2j5Zyo5LiL6L296KeG6aKR77yaICIgKyBtZWRpYUlkKTsKICAgICAgICAgICAgaW5qZWN0T25lQnV0dG9uKHZpZGVvRGl2LnBhcmVudEVsZW1lbnQsICLkuIvovb3op4bpopEiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgIGRvd25sb2FkVmlkZW8oZXZlbnQudGFyZ2V0LCBtZWRpYUlkLCBnZXRQcmVmaXhGcm9tQXJ0aWNsZShkaXYpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5qZWN0QXJ0aXN0UGhvdG9Eb3dubG9hZEJ1dHRvbigpIHsKICAgICAgICB2YXIgaW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjY21zLWlubmVyIik7CiAgICAgICAgdmFyIHRpdGxlLCBpbWdzOwogICAgICAgIGlmIChpbm5lcikgewogICAgICAgICAgICAvLyBOZXcgUGFnZQogICAgICAgICAgICB0aXRsZSA9IGlubmVyLnF1ZXJ5U2VsZWN0b3IoIi5jbXMtc2VjdGlvbl9faW5uZXJfX29uZS1jb2wiKTsKICAgICAgICAgICAgaW1ncyA9IEFycmF5LmZyb20oaW5uZXIucXVlcnlTZWxlY3RvckFsbCgibGRoLWNtcy1pbWcgaW1nIikpLm1hcCgKICAgICAgICAgICAgICAgIChpbWcpID0+IGltZy5zcmMKICAgICAgICAgICAgKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBMZWdhY3kgUGFnZQogICAgICAgICAgICBpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbm5lciIpOwogICAgICAgICAgICB0aXRsZSA9IGlubmVyLnF1ZXJ5U2VsZWN0b3IoInNlY3Rpb24iKTsKICAgICAgICAgICAgaW1ncyA9IEFycmF5LmZyb20oaW5uZXIucXVlcnlTZWxlY3RvckFsbCgiaW1nIikpLm1hcCgoaW1nKSA9PiBpbWcuc3JjKTsKICAgICAgICB9CiAgICAgICAgdmFyIGJ1dHRvbnNEaXYgPSBnZXRCdXR0b25EaXYoKTsKICAgICAgICB0aXRsZS5hcHBlbmQoYnV0dG9uc0Rpdik7CiAgICAgICAgaWYgKCFpc01vYmlsZSgpKSB7CiAgICAgICAgICAgIGluamVjdE9uZUJ1dHRvbigKICAgICAgICAgICAgICAgIGJ1dHRvbnNEaXYsCiAgICAgICAgICAgICAgICAi5LiL6L295omA5pyJ5Zu+54mHICgiICsgaW1ncy5sZW5ndGggKyAiKSIsCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRJbWFnZXMoaW1ncywgZ2V0UHJlZml4RnJvbURvY3VtZW50KCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGluamVjdE9uZUJ1dHRvbigKICAgICAgICAgICAgICAgIGJ1dHRvbnNEaXYsCiAgICAgICAgICAgICAgICAi55Sf5oiQ5Zu+54mH6ZO+5o6lKCIgKyBpbWdzLmxlbmd0aCArICIpIiwKICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBnZW5lcmF0ZU9uQ2xpY2tIYW5kbGVyKGJ1dHRvbnNEaXYsIGltZ3MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBpbmplY3RPZmZzaG90RG93bmxvYWRCdXR0b24oKSB7CiAgICAgICAgdmFyIGlubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmlubmVyIik7CiAgICAgICAgdmFyIGRpdnMgPSBBcnJheS5mcm9tKGlubmVyLnF1ZXJ5U2VsZWN0b3JBbGwoImRpdltpZF49J2pzLWdhbGxlcnknXSIpKTsKICAgICAgICBkaXZzLmZvckVhY2goKGRpdikgPT4gewogICAgICAgICAgICB2YXIgYnV0dG9uc0RpdiA9IGdldEJ1dHRvbkRpdigpOwogICAgICAgICAgICBkaXYucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChidXR0b25zRGl2KTsKICAgICAgICAgICAgdmFyIGltZ3MgPSBBcnJheS5mcm9tKGRpdi5xdWVyeVNlbGVjdG9yQWxsKCJhIikpLm1hcCgKICAgICAgICAgICAgICAgIChhKSA9PiBuZXcgVVJMKGEuaHJlZiwgd2luZG93LmxvY2F0aW9uLm9yaWdpbikuaHJlZgogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoIWlzTW9iaWxlKCkpIHsKICAgICAgICAgICAgICAgIGluamVjdE9uZUJ1dHRvbigKICAgICAgICAgICAgICAgICAgICBidXR0b25zRGl2LAogICAgICAgICAgICAgICAgICAgICLkuIvovb3lm77niYcgKCIgKyBpbWdzLmxlbmd0aCArICIpIiwKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkSW1hZ2VzKGltZ3MsIGdldFByZWZpeEZyb21Eb2N1bWVudCgpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5qZWN0UGVyVmlkZW9Eb3dubG9hZEJ1dHRvbkZvclRpbWVsaW5lKGRpdikgewogICAgICAgIGRpdi5xdWVyeVNlbGVjdG9yQWxsKCJhLnBvcHVwX2xpbmsiKS5mb3JFYWNoKCh2aWRlb0RpdikgPT4gewogICAgICAgICAgICB2YXIgbWVkaWFJZCA9IHZpZGVvRGl2CiAgICAgICAgICAgICAgICAuZ2V0QXR0cmlidXRlKCJvbmNsaWNrIikKICAgICAgICAgICAgICAgIC5zcGxpdCgibW92aWUvIilbMV0KICAgICAgICAgICAgICAgIC5zcGxpdCgiLyIpWzBdOwogICAgICAgICAgICBtb0Rvd25sb2FkZXJEZWJ1Zygi5q2j5Zyo5LiL6L296KeG6aKR77yaICIgKyBtZWRpYUlkKTsKICAgICAgICAgICAgaW5qZWN0T25lQnV0dG9uKHZpZGVvRGl2LnBhcmVudEVsZW1lbnQsICLkuIvovb3op4bpopEiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgIGRvd25sb2FkVmlkZW8oZXZlbnQudGFyZ2V0LCBtZWRpYUlkLCBnZXRQcmVmaXhGcm9tQXJ0aWNsZShkaXYpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5qZWN0RkNNYWdhemluZUJ1dHRvbigpIHsKICAgICAgICB2YXIgYXJ0aWNsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImFydGljbGUiKTsKICAgICAgICB2YXIgaW1ncyA9IEFycmF5LmZyb20oYXJ0aWNsZS5xdWVyeVNlbGVjdG9yQWxsKCJpbWciKSkubWFwKAogICAgICAgICAgICAoaW1nKSA9PgogICAgICAgICAgICAgICAgbmV3IFVSTChpbWcuZ2V0QXR0cmlidXRlKCJkYXRhLXNyYyIpIHx8IGltZy5zcmMsIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pCiAgICAgICAgICAgICAgICAgICAgLmhyZWYKICAgICAgICApOwogICAgICAgIGltZ3MgPSBbLi4ubmV3IFNldChpbWdzKV07CiAgICAgICAgdmFyIGJ1dHRvbnNEaXYgPSBnZXRCdXR0b25EaXYoKTsKICAgICAgICBhcnRpY2xlLmluc2VydEJlZm9yZShidXR0b25zRGl2LCBhcnRpY2xlLmZpcnN0Q2hpbGQpOwogICAgICAgIGluamVjdE9uZUJ1dHRvbigKICAgICAgICAgICAgYnV0dG9uc0RpdiwKICAgICAgICAgICAgIuS4i+i9veWFqOmDqOWbvueJhyAoIiArIGltZ3MubGVuZ3RoICsgIikiLAogICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBkb3dubG9hZEltYWdlcyhpbWdzLCBnZXRQcmVmaXhGcm9tQXJ0aWNsZShhcnRpY2xlKSk7CiAgICAgICAgICAgIH0KICAgICAgICApOwogICAgICAgIEFycmF5LmZyb20oYXJ0aWNsZS5xdWVyeVNlbGVjdG9yQWxsKCIuanMtaW1nIikpLmZvckVhY2goKGpzSW1nKSA9PiB7CiAgICAgICAgICAgIHZhciBidXR0b25zRGl2ID0gZ2V0QnV0dG9uRGl2KCk7CiAgICAgICAgICAgIGpzSW1nLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGJ1dHRvbnNEaXYsIGpzSW1nKTsKICAgICAgICAgICAgdmFyIGltZ3MgPSBBcnJheS5mcm9tKGpzSW1nLnF1ZXJ5U2VsZWN0b3JBbGwoImltZyIpKS5tYXAoCiAgICAgICAgICAgICAgICAoaW1nKSA9PgogICAgICAgICAgICAgICAgICAgIG5ldyBVUkwoCiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5nZXRBdHRyaWJ1dGUoImRhdGEtc3JjIikgfHwgaW1nLnNyYywKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLm9yaWdpbgogICAgICAgICAgICAgICAgICAgICkuaHJlZgogICAgICAgICAgICApOwogICAgICAgICAgICBpbmplY3RPbmVCdXR0b24oCiAgICAgICAgICAgICAgICBidXR0b25zRGl2LAogICAgICAgICAgICAgICAgIuS4i+i9veWbvueJhyAoIiArIGltZ3MubGVuZ3RoICsgIikiLAogICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkSW1hZ2VzKGltZ3MsIGdldFByZWZpeEZyb21BcnRpY2xlKGFydGljbGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICB9KTsKICAgICAgICBBcnJheS5mcm9tKAogICAgICAgICAgICBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3JBbGwoIi5qcy1nYWxsZXJ5IC5jLWdhbGxlcnlfX21haW4iKQogICAgICAgICkuZm9yRWFjaCgoanNHYWxsZXJ5KSA9PiB7CiAgICAgICAgICAgIHZhciBidXR0b25zRGl2ID0gZ2V0QnV0dG9uRGl2KCk7CiAgICAgICAgICAgIGpzR2FsbGVyeS5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShidXR0b25zRGl2LCBqc0dhbGxlcnkpOwogICAgICAgICAgICB2YXIgaW1ncyA9IEFycmF5LmZyb20oanNHYWxsZXJ5LnF1ZXJ5U2VsZWN0b3JBbGwoImltZyIpKS5tYXAoCiAgICAgICAgICAgICAgICAoaW1nKSA9PgogICAgICAgICAgICAgICAgICAgIG5ldyBVUkwoCiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5nZXRBdHRyaWJ1dGUoImRhdGEtc3JjIikgfHwgaW1nLnNyYywKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLm9yaWdpbgogICAgICAgICAgICAgICAgICAgICkuaHJlZgogICAgICAgICAgICApOwogICAgICAgICAgICBpbWdzID0gWy4uLm5ldyBTZXQoaW1ncyldOwogICAgICAgICAgICBpbmplY3RPbmVCdXR0b24oCiAgICAgICAgICAgICAgICBidXR0b25zRGl2LAogICAgICAgICAgICAgICAgIuS4i+i9veWFqOmDqOWbvueJhyAoIiArIGltZ3MubGVuZ3RoICsgIikiLAogICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkSW1hZ2VzKGltZ3MsIGdldFByZWZpeEZyb21BcnRpY2xlKGFydGljbGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBpbmplY3RPbmVCdXR0b24oCiAgICAgICAgZWxlbWVudCwKICAgICAgICB0ZXh0T25CdXR0b24sCiAgICAgICAgY2xpY2tMaXN0ZW5lciwKICAgICAgICBleHRyYVN0eWxlID0gIiIKICAgICkgewogICAgICAgIHZhciBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJCVVRUT04iKTsKICAgICAgICB2YXIgYnRuVGV4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRleHRPbkJ1dHRvbik7CiAgICAgICAgYnRuLmFwcGVuZENoaWxkKGJ0blRleHQpOwogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGNsaWNrTGlzdGVuZXIpOwogICAgICAgIGJ0bi5zdHlsZSA9CiAgICAgICAgICAgICJiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgYm9yZGVyOiBzb2xpZCAjODA4MDgwIDJweDsgYm9yZGVyLXJhZGl1czogMjBweDsgY29sb3I6ICM1NDU0NTQ7IG1hcmdpbjogMC4yZW07IiArCiAgICAgICAgICAgIGV4dHJhU3R5bGU7CiAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChidG4pOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJ1dHRvbkRpdigpIHsKICAgICAgICB2YXIgYnV0dG9uc0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgIGJ1dHRvbnNEaXYuY2xhc3NOYW1lID0gImxkaC1tby1kbCI7CiAgICAgICAgYnV0dG9uc0Rpdi5zdHlsZSA9ICJtYXJnaW4tdG9wOiAwLjRlbTsgbWFyZ2luLWJvdHRvbTogMC40ZW0iOwogICAgICAgIHJldHVybiBidXR0b25zRGl2OwogICAgfQoKICAgIGZ1bmN0aW9uIGdlbmVyYXRlT25DbGlja0hhbmRsZXIoYnV0dG9uc0RpdiwgaW1ncykgewogICAgICAgIHZhciB0ZXh0YXJlYSA9IGJ1dHRvbnNEaXYucXVlcnlTZWxlY3RvcigidGV4dGFyZWEubGRoLW1vLWRsIik7CiAgICAgICAgaWYgKCF0ZXh0YXJlYSkgewogICAgICAgICAgICB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRleHRhcmVhIik7CiAgICAgICAgICAgIHRleHRhcmVhLmNsYXNzTmFtZSA9ICJsZGgtbW8tZGwiOwogICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZSA9ICJoZWlnaHQ6IDEwMHB4OyB3aWR0aDogODAlOyI7CiAgICAgICAgICAgIHZhciBiciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJyIik7CiAgICAgICAgICAgIGJ1dHRvbnNEaXYuaW5zZXJ0QmVmb3JlKGJyLCBidXR0b25zRGl2LmZpcnN0Q2hpbGQpOwogICAgICAgICAgICBidXR0b25zRGl2Lmluc2VydEJlZm9yZSh0ZXh0YXJlYSwgYnV0dG9uc0Rpdi5maXJzdENoaWxkKTsKICAgICAgICB9CiAgICAgICAgdGV4dGFyZWEudmFsdWUgPSBpbWdzLmpvaW4oIlxuIik7CiAgICAgICAgdGV4dGFyZWEuc2VsZWN0KCk7CiAgICB9CgogICAgZnVuY3Rpb24gY3VzdG9taXplZFRpbWVsaW5lUGFnZSgpIHsKICAgICAgICAvLyDliJ3lp4vljJYKICAgICAgICBkb2N1bWVudAogICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbCgibGRoLWluZmluaXRlLXNjcm9sbCBhcnRpY2xlIikKICAgICAgICAgICAgLmZvckVhY2goKGFydGljbGUpID0+IGF0dGFjaEJ1dHRvblRvQXJ0aWNsZShhcnRpY2xlKSk7CiAgICAgICAgZG9jdW1lbnQKICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoImxkaC1pbmZpbml0ZS1zY3JvbGwgbGRoLWltYWdlZGlhcnktdGltZWxpbmUtbGlzdC1pdGVtIikKICAgICAgICAgICAgLmZvckVhY2goKGFydGljbGUpID0+IGF0dGFjaEJ1dHRvblRvQXJ0aWNsZShhcnRpY2xlKSk7CiAgICAgICAgY29uc3QgaW5maW5pdGVTY3JvbGxDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKAogICAgICAgICAgICAibGRoLWluZmluaXRlLXNjcm9sbCIKICAgICAgICApOwogICAgICAgIGNvbnN0IGNvbmZpZyA9IHsgY2hpbGRMaXN0OiB0cnVlIH07CiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zLCBvYnNlcnZlcikgewogICAgICAgICAgICB2YXIgbm9kZXMgPSBtdXRhdGlvbnMuZmluZCgocikgPT4KICAgICAgICAgICAgICAgIEFycmF5LmZyb20oci5hZGRlZE5vZGVzKS5maWx0ZXIoCiAgICAgICAgICAgICAgICAgICAgKG4pID0+CiAgICAgICAgICAgICAgICAgICAgICAgIG4uY2xhc3NOYW1lID09ICJhcnRpY2xlIiB8fAogICAgICAgICAgICAgICAgICAgICAgICBuLmNsYXNzTmFtZSA9PSAibGRoLWltYWdlZGlhcnktdGltZWxpbmUtbGlzdC1pdGVtIgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApLmFkZGVkTm9kZXM7CiAgICAgICAgICAgIG5vZGVzLmZvckVhY2goKG5vZGUpID0+CiAgICAgICAgICAgICAgICBhdHRhY2hCdXR0b25Ub0FydGljbGUoCiAgICAgICAgICAgICAgICAgICAgbm9kZS5xdWVyeVNlbGVjdG9yKCJhcnRpY2xlIikgfHwKICAgICAgICAgICAgICAgICAgICBub2RlLnF1ZXJ5U2VsZWN0b3IoImxkaC1pbWFnZWRpYXJ5LXRpbWVsaW5lLWxpc3QtaXRlbSIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJlbW92ZVByb3RlY3RJbWcoKTsKICAgICAgICAgICAgbW9Eb3dubG9hZGVyRGVidWcoIuino+mZpOWIt+aWsOWQjuaXtumXtOe6v+WPs+mUrumZkOWItiIpOwogICAgICAgIH0pOwogICAgICAgIG9ic2VydmVyLm9ic2VydmUoaW5maW5pdGVTY3JvbGxDb250YWluZXIsIGNvbmZpZyk7CiAgICAgICAgbW9Eb3dubG9hZGVyTG9nKCJUaW1lbGluZemhtemdouazqOWFpeaMiemSriIpOwogICAgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gPSAgICBEb3dubG9hZCBVdGlscyAgICA9CiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICBmdW5jdGlvbiBkb3dubG9hZEltYWdlcyhpbWdzLCBwcmVmaXggPSAiIikgewogICAgICAgIG1vRG93bmxvYWRlckRlYnVnKCLmraPlnKjkuIvovb3lm77niYfvvJogIiArIGltZ3MpOwogICAgICAgIC8vIFRoYW5rcyB0byBodHRwczovL2dpdGh1Yi5jb20veTI1MjMyOC9JbnN0YWdyYW1fRG93bmxvYWRfQnV0dG9uCiAgICAgICAgaWYgKGltZ3MubGVuZ3RoIDw9IDEwKSB7CiAgICAgICAgICAgIC8vIOWQjOaXtuacgOWkmuS4i+i9veWNgeW8oOWbvgogICAgICAgICAgICBpbWdzLmZvckVhY2goKGltZykgPT4gZG93bmxvYWRPbmVJbWFnZShpbWcsIHByZWZpeCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIOiuvue9ruW7tuaXtuS4i+i9veabtOWkmuWbvueJhyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy81NjI0NDkwMi81NjI0NTYxMCM1NjI0NTYxMAogICAgICAgICAgICBpbWdzLmZvckVhY2goKGltZywgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkT25lSW1hZ2UoaW1nLCBwcmVmaXgpOwogICAgICAgICAgICAgICAgfSwgaW5kZXggKiAyMDApOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZG93bmxvYWRPbmVJbWFnZShpbWcsIHByZWZpeCA9ICIiKSB7CiAgICAgICAgZmV0Y2goaW1nLCB7CiAgICAgICAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHsKICAgICAgICAgICAgICAgIE9yaWdpbjogd2luZG93LmxvY2F0aW9uLm9yaWdpbiwKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIG1vZGU6ICJjb3JzIiwKICAgICAgICAgICAgY2FjaGU6ICJuby1jYWNoZSIsCiAgICAgICAgfSkKICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5ibG9iKCkpCiAgICAgICAgICAgIC50aGVuKChibG9iKSA9PgogICAgICAgICAgICAgICAgZG93bG9hZEJsb2IoCiAgICAgICAgICAgICAgICAgICAgd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYiksCiAgICAgICAgICAgICAgICAgICAgcHJlZml4ICsgaW1nLnN1YnN0cmluZyhpbWcubGFzdEluZGV4T2YoIi8iKSArIDEpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICAgICAgLmNhdGNoKChlKSA9PiBjb25zb2xlLmVycm9yKGUpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkb3dubG9hZFZpZGVvKGJ1dHRvbiwgdmlkZW8sIHByZWZpeCA9ICIiKSB7CiAgICAgICAgY29uc3QgdmlkZW9SZXF1ZXN0VVJMID0KICAgICAgICAgICAgImh0dHBzOi8vcHJvZHVjdGlvbi1wcy5sdnAubGxudy5uZXQvci9QbGF5bGlzdFNlcnZpY2UvbWVkaWEvPG1lZGlhSWQ+L2dldE1vYmlsZVBsYXlsaXN0QnlNZWRpYUlkIjsKICAgICAgICBmZXRjaCh2aWRlb1JlcXVlc3RVUkwucmVwbGFjZSgiPG1lZGlhSWQ+IiwgdmlkZW8pLCB7CiAgICAgICAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHsKICAgICAgICAgICAgICAgIE9yaWdpbjogd2luZG93LmxvY2F0aW9uLm9yaWdpbiwKICAgICAgICAgICAgICAgIFJlZmVyZXI6IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBtb2RlOiAiY29ycyIsCiAgICAgICAgICAgIGNhY2hlOiAibm8tY2FjaGUiLAogICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgIC8vIOS4u20zdTgKICAgICAgICAgICAgICAgIGxldCBtM3U4VXJsID0gcmVzcG9uc2UubWVkaWFMaXN0WzBdLm1vYmlsZVVybHMKICAgICAgICAgICAgICAgICAgICAuZmluZCgodikgPT4gdi50YXJnZXRNZWRpYVBsYXRmb3JtID09ICJIdHRwTGl2ZVN0cmVhbWluZyIpCiAgICAgICAgICAgICAgICAgICAgLm1vYmlsZVVybC5yZXBsYWNlKCJodHRwOi8vIiwgImh0dHBzOi8vIik7CiAgICAgICAgICAgICAgICBmZXRjaChtM3U4VXJsKQogICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UudGV4dCgpKQogICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAvLyDojrflj5ZtM3U45Lit5pyA6auY5riF55qECiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhbmR3aXRoUmUgPSAvQkFORFdJRFRIPShcZCspL2k7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGlnaWJsZVN0cmVhbXNSYXcgPSByZXNwb25zZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCIjRVhULVgtU1RSRUFNLUlORjoiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNsaWNlKDEpOwogICAgICAgICAgICAgICAgICAgICAgICBlbGlnaWJsZVN0cmVhbXNSYXcuc29ydCgoYSwgYikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludChiLm1hdGNoKGJhbmR3aXRoUmUpWzFdKSAtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoYS5tYXRjaChiYW5kd2l0aFJlKVsxXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FuZGlkYXRlID0gZWxpZ2libGVTdHJlYW1zUmF3WzBdLnNwbGl0KCJcbiIpWzFdOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVSTChjYW5kaWRhdGUsIG5ldyBVUkwobTN1OFVybCkub3JpZ2luKS5ocmVmOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKG0zdThVcmwpID0+CiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5NM1U4VG9vbEJveCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0zdThVcmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmaXggKyBnZXRGaWxlbmFtZUZyb21WaWRlb1VybChtM3U4VXJsKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gZG93bG9hZEJsb2IoYmxvYiwgZmlsZW5hbWUpIHsKICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICBhLmRvd25sb2FkID0gZmlsZW5hbWU7CiAgICAgICAgYS5ocmVmID0gYmxvYjsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOwogICAgICAgIGEuY2xpY2soKTsKICAgICAgICBhLnJlbW92ZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9wZW5NM1U4VG9vbEJveChidXR0b24sIG0zdThVcmwsIGZpbGVuYW1lKSB7CiAgICAgICAgLy8g5omT5byAIGh0dHBzOi8vdG9vbHMudGhhdHdpbmQuY29tL3Rvb2wvbTN1OGRvd25sb2FkZXIKICAgICAgICBpZiAoaXNNb2JpbGUoKSkgewogICAgICAgICAgICBsZXQgaWQgPSBidG9hKGVuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSkpOwogICAgICAgICAgICB2YXIgYSA9IGJ1dHRvbi5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoImEubW8tZG93bmxvYWRlciIpOwogICAgICAgICAgICBpZiAoIWEpIHsKICAgICAgICAgICAgICAgIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgICAgICB2YXIgYVRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgi54K55Ye75omT5byA5LiL6L296aG16Z2iIik7CiAgICAgICAgICAgICAgICBhLmNsYXNzTmFtZSA9ICJtby1kb3dubG9hZGVyIjsKICAgICAgICAgICAgICAgIGEuYXBwZW5kKGFUZXh0KTsKICAgICAgICAgICAgICAgIGEudGFyZ2V0ID0gIl9ibGFuayI7CiAgICAgICAgICAgICAgICBhLmhyZWYgPSBjb25zdHJ1Y3RNM1U4VG9vbEJveFVSTChtM3U4VXJsLCBmaWxlbmFtZSk7CiAgICAgICAgICAgICAgICBidXR0b24ucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJiciIpKTsKICAgICAgICAgICAgICAgIGJ1dHRvbi5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGEpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICAgICAgYS50YXJnZXQgPSAiX2JsYW5rIjsKICAgICAgICAgICAgYS5ocmVmID0gY29uc3RydWN0TTNVOFRvb2xCb3hVUkwobTN1OFVybCwgZmlsZW5hbWUpOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOwogICAgICAgICAgICBhLmNsaWNrKCk7CiAgICAgICAgICAgIGEucmVtb3ZlKCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGNvbnN0cnVjdE0zVThUb29sQm94VVJMKG0zdThVcmwsIGZpbGVuYW1lKSB7CiAgICAgICAgdmFyIHVybCA9CiAgICAgICAgICAgICJodHRwczovL3Rvb2xzLnRoYXR3aW5kLmNvbS90b29sL20zdThkb3dubG9hZGVyIyIgKwogICAgICAgICAgICAibTN1OD0iICsKICAgICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KG0zdThVcmwpICsKICAgICAgICAgICAgIiZyZWZlcmVyPSIgKwogICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLmhyZWYpICsKICAgICAgICAgICAgIiZmaWxlbmFtZT0iICsKICAgICAgICAgICAgZmlsZW5hbWU7CiAgICAgICAgbW9Eb3dubG9hZGVyRGVidWcodXJsKTsKICAgICAgICByZXR1cm4gdXJsOwogICAgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vID0gICAgTmFtaW5nIFV0aWxzICAgID0KICAgIC8vID09PT09PT09PT09PT09PT09PT09PT0KCiAgICBmdW5jdGlvbiBnZXRQcmVmaXhGcm9tQXJ0aWNsZShhcnRpY2xlKSB7CiAgICAgICAgdmFyIGNhbmRpZGF0ZSA9CiAgICAgICAgICAgIGFydGljbGUucXVlcnlTZWxlY3RvcigiLmFydGljbGVfX2hlYWQiKSB8fAogICAgICAgICAgICBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoIi5hcnRpY2xlX19oZWFkZXIiKSB8fAogICAgICAgICAgICBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoIi5wLWRldGFpbF9hcnRpY2xlX19oZWFkZXItdGV4dCIpOwogICAgICAgIGlmIChjYW5kaWRhdGUpIHsKICAgICAgICAgICAgcmV0dXJuIHNhbml0aXplRmlsZU5hbWUoCiAgICAgICAgICAgICAgICBjYW5kaWRhdGUudGV4dENvbnRlbnQKICAgICAgICAgICAgICAgICAgICAuc3BsaXQoL1xzL2cpCiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigocykgPT4gcykKICAgICAgICAgICAgICAgICAgICAuam9pbigiXyIpICsgIl8iCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBnZXRQcmVmaXhGcm9tRG9jdW1lbnQoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRQcmVmaXhGcm9tRG9jdW1lbnQoKSB7CiAgICAgICAgLy8g5aaC5p6c5a2Y5Zyo77yM5L2/55SobW92aWXmoIfpopgKICAgICAgICB2YXIgY2FuZGlkYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLm1vdmllLXRpdGxlLWJsb2NrIik7CiAgICAgICAgaWYgKGNhbmRpZGF0ZSkgewogICAgICAgICAgICByZXR1cm4gc2FuaXRpemVGaWxlTmFtZSgKICAgICAgICAgICAgICAgIGNhbmRpZGF0ZS50ZXh0Q29udGVudAogICAgICAgICAgICAgICAgICAgIC5zcGxpdCgvXHMvZykKICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKChzKSA9PiBzKQogICAgICAgICAgICAgICAgICAgIC5qb2luKCJfIikgKyAiXyIKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNhbml0aXplRmlsZU5hbWUoZG9jdW1lbnQudGl0bGUuc3BsaXQoInwiKVswXSArICJfIik7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RmlsZW5hbWVGcm9tVmlkZW9VcmwodXJsKSB7CiAgICAgICAgbGV0IHRlbXBOYW1lID0gdXJsLnJlcGxhY2UoIi9yb290LW1lc3NhZ2UtY3hmLWFwYWNoZSIsICIiKTsKICAgICAgICB0ZW1wTmFtZSA9IHRlbXBOYW1lCiAgICAgICAgICAgIC5zdWJzdHJpbmcodGVtcE5hbWUubGFzdEluZGV4T2YoIi8iKSArIDEpCiAgICAgICAgICAgIC5yZXBsYWNlKCIubTN1OCIsICIudHMiKTsKICAgICAgICByZXR1cm4gdGVtcE5hbWU7CiAgICB9CgogICAgZnVuY3Rpb24gc2FuaXRpemVGaWxlTmFtZShpbnB1dCwgcmVwbGFjZW1lbnQgPSAiXyIpIHsKICAgICAgICAvLyBUaGFua3MgdG8gaHR0cHM6Ly9naXRodWIuY29tL3BhcnNoYXAvbm9kZS1zYW5pdGl6ZS1maWxlbmFtZS9ibG9iL21hc3Rlci9pbmRleC5qcwogICAgICAgIGNvbnN0IGlsbGVnYWxSZSA9IC9bXC9cPzw+XFw6XCpcfCJdL2c7CiAgICAgICAgY29uc3QgY29udHJvbFJlID0gL1tceDAwLVx4MWZceDgwLVx4OWZdL2c7CiAgICAgICAgY29uc3QgcmVzZXJ2ZWRSZSA9IC9eXC4rJC87CiAgICAgICAgY29uc3Qgd2luZG93c1Jlc2VydmVkUmUgPSAvXihjb258cHJufGF1eHxudWx8Y29tWzAtOV18bHB0WzAtOV0pKFwuLiopPyQvaTsKICAgICAgICBjb25zdCB3aW5kb3dzVHJhaWxpbmdSZSA9IC9bXC4gXSskLzsKICAgICAgICByZXR1cm4gaW5wdXQKICAgICAgICAgICAgLnJlcGxhY2UoaWxsZWdhbFJlLCByZXBsYWNlbWVudCkKICAgICAgICAgICAgLnJlcGxhY2UoY29udHJvbFJlLCByZXBsYWNlbWVudCkKICAgICAgICAgICAgLnJlcGxhY2UocmVzZXJ2ZWRSZSwgcmVwbGFjZW1lbnQpCiAgICAgICAgICAgIC5yZXBsYWNlKHdpbmRvd3NSZXNlcnZlZFJlLCByZXBsYWNlbWVudCkKICAgICAgICAgICAgLnJlcGxhY2Uod2luZG93c1RyYWlsaW5nUmUsIHJlcGxhY2VtZW50KTsKICAgIH0KCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gPSAgICBMb2dnaW5nIFV0aWxzICAgID0KICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09CgogICAgZnVuY3Rpb24gbW9Eb3dubG9hZGVyTG9nKG1zZykgewogICAgICAgIGNvbnNvbGUubG9nKCJbbW8tZG93bmxvZGVyXSAiICsgbXNnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBtb0Rvd25sb2FkZXJEZWJ1Zyhtc2cpIHsKICAgICAgICBjb25zb2xlLmRlYnVnKCJbbW8tZG93bmxvZGVyXSAiICsgbXNnKTsKICAgIH0KfSkoKTsK"
}