{
  "match": 0,
  "info": "mo\u4e0b\u8f7d\u5668",
  "regex": "m.tribe-m.jp@@m.ex-m.jp@@m.ldh-m.jp@@m.ldhgirls-m.jp",
  "runat": 0,
  "version": "0.36",
  "author": "\u4e59\u919a",
  "name": "mo\u4e0b\u8f7d\u5668",
  "code": "Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgICAgbW8gKExESCkg5LiL6L295ZmoCi8vIEBuYW1lc3BhY2UgICAgICAgICAgIGh0dHBzOi8vMW1ldGhlci5tZS8KLy8gQHZlcnNpb24gICAgICAgICAgICAgMC4zNgovLyBAZGVzY3JpcHRpb24gICAgICAgICDlnKhtb+eahOWGheWuuemhteWinuWKoOWbvueJh+WSjOinhumikeS4i+i9veeahOaMiemSru+8jCDop6PplIHlj7PplK7lip/og70KLy8gQGF1dGhvciAgICAgICAgICAgICAg5LmZ6YaaKEBsb2NvZGEpCi8vIEBtYXRjaCAgICAgICAgICAgICAgIGh0dHAqOi8vbS50cmliZS1tLmpwLyoKLy8gQG1hdGNoICAgICAgICAgICAgICAgaHR0cCo6Ly9tLmV4LW0uanAvKgovLyBAbWF0Y2ggICAgICAgICAgICAgICBodHRwKjovL20ubGRoLW0uanAvKgovLyBAbWF0Y2ggICAgICAgICAgICAgICBodHRwKjovL20ubGRoZ2lybHMtbS5qcC8qCi8vIEBtYXRjaCAgICAgICAgICAgICAgIGh0dHAqOi8vaWQuZXhmYW1pbHkuanAvcy9sZGgvKgovLyBAaWNvbiAgICAgICAgICAgICAgICBodHRwczovL3d3dy5nb29nbGUuY29tL3MyL2Zhdmljb25zP3N6PTY0JmRvbWFpbj1sZGguY28uanAKLy8gQHNvdXJjZSAgICAgICAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2xvY29kYS9tby1kb3dubG9hZGVyCi8vIEBsaWNlbnNlICAgICAgICAgICAgIE1JVAovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbiAoKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICAvLyA9PT09PT09PT09PT09PT09CiAgICAvLyA9ICAgIENvbnN0cyAgICA9CiAgICAvLyA9PT09PT09PT09PT09PT09CgogICAgY29uc3QgaXNNb2JpbGUgPSAoKSA9PgogICAgICAgIC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdCgKICAgICAgICAgICAgbmF2aWdhdG9yLnVzZXJBZ2VudAogICAgICAgICk7CgogICAgY29uc3Qga2V5d29yZHMgPSBbInVwbGNtbiIsICJ1cGxvYWQiXTsKCiAgICAvLyA9PT09PT09PT09PT09PQogICAgLy8gPSAgICBNYWluICAgID0KICAgIC8vID09PT09PT09PT09PT09CiAgICAKICAgIC8vIE1vIOS4i+i9veWbvueJhwogICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCItbS5qcCIpKSB7CiAgICAgICAgLy8g5Yig6Zmk5Zu+54mH5L+d5oqkCiAgICAgICAgcmVtb3ZlUHJvdGVjdEltZygpOwogICAgICAgIC8vIOWcqOivpuaDhemhteazqOWFpeaMiemSrgogICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygiZGV0YWlsIikpIHsKICAgICAgICAgICAgaW5qZWN0RG93bmxvYWRBbGxCdXR0b25zKCk7CiAgICAgICAgfQogICAgICAgIC8vIOagueaNruinhumikeazqOWFpeaMiemSrgogICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygibW92aWUiKSkgewogICAgICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZGl2LmxpbWVsaWdodC1wbGF5ZXIiKSkgewogICAgICAgICAgICAgICAgaW5qZWN0UGVyVmlkZW9Eb3dubG9hZEJ1dHRvbihkb2N1bWVudCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8g5Zyo5pe26Ze06L2055WM6Z2i6K6+572uTGlzdGVuZXIKICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoInRpbWVsaW5lIikpIHsKICAgICAgICAgICAgLy8g562J5b6F5Yqg6L29c2Nyb2xsCiAgICAgICAgICAgIChmdW5jdGlvbiBpbml0KCkgewogICAgICAgICAgICAgICAgdmFyIGNvdW50ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJsZGgtaW5maW5pdGUtc2Nyb2xsIik7CiAgICAgICAgICAgICAgICBpZiAoY291bnRlcikgewogICAgICAgICAgICAgICAgICAgIC8vIOiuvue9ruaMiemSruWSjOebkeWQrAogICAgICAgICAgICAgICAgICAgIGN1c3RvbWl6ZWRUaW1lbGluZVBhZ2UoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChpbml0LCAzMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSgpOwogICAgICAgIH0KICAgICAgICAvLyBB5YaZ6aG16Z2i5rOo5YWl5oyJ6ZKuCiAgICAgICAgaWYgKAogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygiYXJ0aXN0cGhvdG8iKSB8fAogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygiYXJ0aXN0X3Bob3RvIikKICAgICAgICApIHsKICAgICAgICAgICAgaW5qZWN0QXJ0aXN0UGhvdG9Eb3dubG9hZEJ1dHRvbigpOwogICAgICAgIH0KICAgICAgICAvLyBPZmZzaG906aG16Z2i5rOo5YWl5oyJ6ZKuCiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCJsZGhfb2ZmX3Nob3QiKSkgewogICAgICAgICAgICBpbmplY3RPZmZzaG90RG93bmxvYWRCdXR0b24oKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gRkMg5LiL6L295Zu+54mHCiAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoImV4ZmFtaWx5LmpwIikpIHsKICAgICAgICAvLyBGQyBNYWdhemluZSDkuIvovb3lm77niYcKICAgICAgICBpbmplY3RGQ01hZ2F6aW5lQnV0dG9uKCk7CiAgICB9CgogICAgLy8gPT09PT09PT09PT09PT09CiAgICAvLyA9ICAgIFV0aWxzICAgID0KICAgIC8vID09PT09PT09PT09PT09PQoKICAgIGZ1bmN0aW9uIHJlbW92ZVByb3RlY3RJbWcoKSB7CiAgICAgICAgLy8g56e76Zmk5Y+z6ZSu6ZmQ5Yi2CiAgICAgICAgZG9jdW1lbnQub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfTsKICAgICAgICAvLyDnp7vpmaRwcm90ZWN0aW1n6ZmQ5Yi2CiAgICAgICAgZG9jdW1lbnQKICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoIi5wcm90ZWN0aW1nIikKICAgICAgICAgICAgLmZvckVhY2goKG5vZGUpID0+IG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgicHJvdGVjdGltZyIpKTsKICAgICAgICBtb0Rvd25sb2FkZXJMb2coIuenu+mZpOWPs+mUrumZkOWItiIpOwogICAgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyA9ICAgIEJ1dHRvbiBJbmplY3Rpb24gVXRpbHMgICAgPQogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICBmdW5jdGlvbiBpbmplY3REb3dubG9hZEFsbEJ1dHRvbnMoKSB7CiAgICAgICAgdmFyIGFydGljbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJhcnRpY2xlIik7CiAgICAgICAgaWYgKGFydGljbGUuY2xhc3NMaXN0LmNvbnRhaW5zKCJhcnRpY2xlLS1uZXdzIikpIHsKICAgICAgICAgICAgLy8g5paw6Ze76aG16Z2i54m55q6K5aSE55CGCiAgICAgICAgICAgIGFydGljbGUgPSBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoIi5hcnRpY2xlX19ib2R5Iik7CiAgICAgICAgfQogICAgICAgIGF0dGFjaEJ1dHRvblRvQXJ0aWNsZShhcnRpY2xlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5kRWxpZ2libGVJbWdzRnJvbUFydGljbGUoYXJ0aWNsZSkgewogICAgICAgIHJldHVybiBBcnJheS5mcm9tKGFydGljbGUucXVlcnlTZWxlY3RvckFsbCgiaW1nIikpCiAgICAgICAgICAgIC5tYXAoKGltZykgPT4gaW1nLnNyYykKICAgICAgICAgICAgLmZpbHRlcigoaW1nKSA9PiBrZXl3b3Jkcy5zb21lKChrKSA9PiBpbWcuaW5jbHVkZXMoaykpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhdHRhY2hCdXR0b25Ub0FydGljbGUoYXJ0aWNsZSkgewogICAgICAgIHZhciBpbWdzID0gZmluZEVsaWdpYmxlSW1nc0Zyb21BcnRpY2xlKGFydGljbGUpOwogICAgICAgIC8vIOazqOWFpeaMiemSriBkaXYKICAgICAgICB2YXIgYnV0dG9uc0RpdiA9IGdldEJ1dHRvbkRpdigpOwogICAgICAgIGFydGljbGUuaW5zZXJ0QmVmb3JlKGJ1dHRvbnNEaXYsIGFydGljbGUuZmlyc3RDaGlsZCk7CiAgICAgICAgLy8g5Zu+54mH6ZO+5o6l55Sf5oiQ5oyJ6ZKuCiAgICAgICAgaWYgKGlzTW9iaWxlKCkpIHsKICAgICAgICAgICAgaW5qZWN0T25lQnV0dG9uKAogICAgICAgICAgICAgICAgYnV0dG9uc0RpdiwKICAgICAgICAgICAgICAgICLnlJ/miJDlm77niYfpk77mjqUoIiArIGltZ3MubGVuZ3RoICsgIikiLAogICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlT25DbGlja0hhbmRsZXIoYnV0dG9uc0RpdiwgaW1ncyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g5Zu+54mH5LiL6L295oyJ6ZKuCiAgICAgICAgICAgIGluamVjdE9uZUJ1dHRvbigKICAgICAgICAgICAgICAgIGJ1dHRvbnNEaXYsCiAgICAgICAgICAgICAgICAi5LiL6L295omA5pyJ5Zu+54mHICgiICsgaW1ncy5sZW5ndGggKyAiKSIsCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRJbWFnZXMoCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRFbGlnaWJsZUltZ3NGcm9tQXJ0aWNsZShhcnRpY2xlKSwKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0UHJlZml4RnJvbUFydGljbGUoYXJ0aWNsZSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICAvLyDop4bpopHkuIvovb3mjInpkq4KICAgICAgICBpZiAoCiAgICAgICAgICAgIGFydGljbGUucXVlcnlTZWxlY3RvcigiZGl2LmxpbWVsaWdodC1wbGF5ZXIiKSB8fAogICAgICAgICAgICBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoImEucG9wdXBfbGluayIpCiAgICAgICAgKSB7CiAgICAgICAgICAgIC8vIExpc3QgVmlldyDop4bpopEKICAgICAgICAgICAgaW5qZWN0UGVyVmlkZW9Eb3dubG9hZEJ1dHRvbihhcnRpY2xlKTsKICAgICAgICAgICAgLy8gVGltZWxpbmUg6KeG6aKRCiAgICAgICAgICAgIGluamVjdFBlclZpZGVvRG93bmxvYWRCdXR0b25Gb3JUaW1lbGluZShhcnRpY2xlKTsKICAgICAgICB9CiAgICAgICAgbW9Eb3dubG9hZGVyTG9nKCLms6jlhaXmjInpkq4iKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpbmplY3RQZXJWaWRlb0Rvd25sb2FkQnV0dG9uKGRpdikgewogICAgICAgIGRpdi5xdWVyeVNlbGVjdG9yQWxsKCJkaXYubGltZWxpZ2h0LXBsYXllciIpLmZvckVhY2goKHZpZGVvRGl2KSA9PiB7CiAgICAgICAgICAgIHZhciBtZWRpYUlkID0gdmlkZW9EaXYuaWQuc3Vic3RyaW5nKHZpZGVvRGl2LmlkLmxhc3RJbmRleE9mKCJfIikgKyAxKTsKICAgICAgICAgICAgbW9Eb3dubG9hZGVyRGVidWcoIuato+WcqOS4i+i9veinhumike+8miAiICsgbWVkaWFJZCk7CiAgICAgICAgICAgIGluamVjdE9uZUJ1dHRvbih2aWRlb0Rpdi5wYXJlbnRFbGVtZW50LCAi5LiL6L296KeG6aKRIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICBkb3dubG9hZFZpZGVvKGV2ZW50LnRhcmdldCwgbWVkaWFJZCwgZ2V0UHJlZml4RnJvbUFydGljbGUoZGl2KSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGluamVjdEFydGlzdFBob3RvRG93bmxvYWRCdXR0b24oKSB7CiAgICAgICAgdmFyIGlubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2Ntcy1pbm5lciIpOwogICAgICAgIHZhciB0aXRsZSwgaW1nczsKICAgICAgICBpZiAoaW5uZXIpIHsKICAgICAgICAgICAgLy8gTmV3IFBhZ2UKICAgICAgICAgICAgdGl0bGUgPSBpbm5lci5xdWVyeVNlbGVjdG9yKCIuY21zLXNlY3Rpb25fX2lubmVyX19vbmUtY29sIik7CiAgICAgICAgICAgIGltZ3MgPSBBcnJheS5mcm9tKGlubmVyLnF1ZXJ5U2VsZWN0b3JBbGwoImxkaC1jbXMtaW1nIGltZyIpKS5tYXAoCiAgICAgICAgICAgICAgICAoaW1nKSA9PiBpbWcuc3JjCiAgICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gTGVnYWN5IFBhZ2UKICAgICAgICAgICAgaW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW5uZXIiKTsKICAgICAgICAgICAgdGl0bGUgPSBpbm5lci5xdWVyeVNlbGVjdG9yKCJzZWN0aW9uIik7CiAgICAgICAgICAgIGltZ3MgPSBBcnJheS5mcm9tKGlubmVyLnF1ZXJ5U2VsZWN0b3JBbGwoImltZyIpKS5tYXAoKGltZykgPT4gaW1nLnNyYyk7CiAgICAgICAgfQogICAgICAgIHZhciBidXR0b25zRGl2ID0gZ2V0QnV0dG9uRGl2KCk7CiAgICAgICAgdGl0bGUuYXBwZW5kKGJ1dHRvbnNEaXYpOwogICAgICAgIGlmICghaXNNb2JpbGUoKSkgewogICAgICAgICAgICBpbmplY3RPbmVCdXR0b24oCiAgICAgICAgICAgICAgICBidXR0b25zRGl2LAogICAgICAgICAgICAgICAgIuS4i+i9veaJgOacieWbvueJhyAoIiArIGltZ3MubGVuZ3RoICsgIikiLAogICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkSW1hZ2VzKGltZ3MsIGdldFByZWZpeEZyb21Eb2N1bWVudCgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpbmplY3RPbmVCdXR0b24oCiAgICAgICAgICAgICAgICBidXR0b25zRGl2LAogICAgICAgICAgICAgICAgIueUn+aIkOWbvueJh+mTvuaOpSgiICsgaW1ncy5sZW5ndGggKyAiKSIsCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZ2VuZXJhdGVPbkNsaWNrSGFuZGxlcihidXR0b25zRGl2LCBpbWdzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gaW5qZWN0T2Zmc2hvdERvd25sb2FkQnV0dG9uKCkgewogICAgICAgIHZhciBpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbm5lciIpOwogICAgICAgIHZhciBkaXZzID0gQXJyYXkuZnJvbShpbm5lci5xdWVyeVNlbGVjdG9yQWxsKCJkaXZbaWRePSdqcy1nYWxsZXJ5J10iKSk7CiAgICAgICAgZGl2cy5tYXAoKGRpdikgPT4gewogICAgICAgICAgICB2YXIgYnV0dG9uc0RpdiA9IGdldEJ1dHRvbkRpdigpOwogICAgICAgICAgICBkaXYucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChidXR0b25zRGl2KTsKICAgICAgICAgICAgdmFyIGltZ3MgPSBBcnJheS5mcm9tKGRpdi5xdWVyeVNlbGVjdG9yQWxsKCJhIikpLm1hcCgKICAgICAgICAgICAgICAgIChhKSA9PiBuZXcgVVJMKGEuaHJlZiwgd2luZG93LmxvY2F0aW9uLm9yaWdpbikuaHJlZgogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoIWlzTW9iaWxlKCkpIHsKICAgICAgICAgICAgICAgIGluamVjdE9uZUJ1dHRvbigKICAgICAgICAgICAgICAgICAgICBidXR0b25zRGl2LAogICAgICAgICAgICAgICAgICAgICLkuIvovb3lm77niYcgKCIgKyBpbWdzLmxlbmd0aCArICIpIiwKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkSW1hZ2VzKGltZ3MsIGdldFByZWZpeEZyb21Eb2N1bWVudCgpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5qZWN0UGVyVmlkZW9Eb3dubG9hZEJ1dHRvbkZvclRpbWVsaW5lKGRpdikgewogICAgICAgIGRpdi5xdWVyeVNlbGVjdG9yQWxsKCJhLnBvcHVwX2xpbmsiKS5mb3JFYWNoKCh2aWRlb0RpdikgPT4gewogICAgICAgICAgICB2YXIgbWVkaWFJZCA9IHZpZGVvRGl2CiAgICAgICAgICAgICAgICAuZ2V0QXR0cmlidXRlKCJvbmNsaWNrIikKICAgICAgICAgICAgICAgIC5zcGxpdCgibW92aWUvIilbMV0KICAgICAgICAgICAgICAgIC5zcGxpdCgiLyIpWzBdOwogICAgICAgICAgICBtb0Rvd25sb2FkZXJEZWJ1Zygi5q2j5Zyo5LiL6L296KeG6aKR77yaICIgKyBtZWRpYUlkKTsKICAgICAgICAgICAgaW5qZWN0T25lQnV0dG9uKHZpZGVvRGl2LnBhcmVudEVsZW1lbnQsICLkuIvovb3op4bpopEiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgIGRvd25sb2FkVmlkZW8oZXZlbnQudGFyZ2V0LCBtZWRpYUlkLCBnZXRQcmVmaXhGcm9tQXJ0aWNsZShkaXYpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5qZWN0RkNNYWdhemluZUJ1dHRvbigpIHsKICAgICAgICB2YXIgYXJ0aWNsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImFydGljbGUiKTsKICAgICAgICB2YXIgaW1ncyA9IEFycmF5LmZyb20oYXJ0aWNsZS5xdWVyeVNlbGVjdG9yQWxsKCJpbWciKSkubWFwKAogICAgICAgICAgICAoaW1nKSA9PgogICAgICAgICAgICAgICAgbmV3IFVSTChpbWcuZ2V0QXR0cmlidXRlKCJkYXRhLXNyYyIpIHx8IGltZy5zcmMsIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pCiAgICAgICAgICAgICAgICAgICAgLmhyZWYKICAgICAgICApOwogICAgICAgIGltZ3MgPSBbLi4ubmV3IFNldChpbWdzKV07CiAgICAgICAgdmFyIGJ1dHRvbnNEaXYgPSBnZXRCdXR0b25EaXYoKTsKICAgICAgICBhcnRpY2xlLmluc2VydEJlZm9yZShidXR0b25zRGl2LCBhcnRpY2xlLmZpcnN0Q2hpbGQpOwogICAgICAgIGluamVjdE9uZUJ1dHRvbihidXR0b25zRGl2LCAi5LiL6L295YWo6YOo5Zu+54mHICgiICsgaW1ncy5sZW5ndGggKyAiKSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgZG93bmxvYWRJbWFnZXMoaW1ncywgZ2V0UHJlZml4RnJvbUFydGljbGUoYXJ0aWNsZSkpOwogICAgICAgIH0pOwogICAgICAgIEFycmF5LmZyb20oYXJ0aWNsZS5xdWVyeVNlbGVjdG9yQWxsKCIuanMtaW1nIikpLmZvckVhY2goCiAgICAgICAgICAgIChqc0ltZykgPT4gewogICAgICAgICAgICAgICAgdmFyIGJ1dHRvbnNEaXYgPSBnZXRCdXR0b25EaXYoKTsKICAgICAgICAgICAgICAgIGpzSW1nLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGJ1dHRvbnNEaXYsIGpzSW1nKTsKICAgICAgICAgICAgICAgIHZhciBpbWdzID0gQXJyYXkuZnJvbShqc0ltZy5xdWVyeVNlbGVjdG9yQWxsKCJpbWciKSkubWFwKAogICAgICAgICAgICAgICAgICAgIChpbWcpID0+CiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBVUkwoaW1nLmdldEF0dHJpYnV0ZSgiZGF0YS1zcmMiKSB8fCBpbWcuc3JjLCB3aW5kb3cubG9jYXRpb24ub3JpZ2luKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhyZWYKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBpbmplY3RPbmVCdXR0b24oYnV0dG9uc0RpdiwgIuS4i+i9veWbvueJhyAoIiArIGltZ3MubGVuZ3RoICsgIikiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRJbWFnZXMoaW1ncywgZ2V0UHJlZml4RnJvbUFydGljbGUoYXJ0aWNsZSkpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgQXJyYXkuZnJvbShhcnRpY2xlLnF1ZXJ5U2VsZWN0b3JBbGwoIi5qcy1nYWxsZXJ5IC5jLWdhbGxlcnlfX21haW4iKSkuZm9yRWFjaCgKICAgICAgICAgICAgKGpzR2FsbGVyeSkgPT4gewogICAgICAgICAgICAgICAgdmFyIGJ1dHRvbnNEaXYgPSBnZXRCdXR0b25EaXYoKTsKICAgICAgICAgICAgICAgIGpzR2FsbGVyeS5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShidXR0b25zRGl2LCBqc0dhbGxlcnkpOwogICAgICAgICAgICAgICAgdmFyIGltZ3MgPSBBcnJheS5mcm9tKGpzR2FsbGVyeS5xdWVyeVNlbGVjdG9yQWxsKCJpbWciKSkubWFwKAogICAgICAgICAgICAgICAgICAgIChpbWcpID0+CiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBVUkwoaW1nLmdldEF0dHJpYnV0ZSgiZGF0YS1zcmMiKSB8fCBpbWcuc3JjLCB3aW5kb3cubG9jYXRpb24ub3JpZ2luKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhyZWYKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBpbWdzID0gWy4uLm5ldyBTZXQoaW1ncyldOwogICAgICAgICAgICAgICAgaW5qZWN0T25lQnV0dG9uKGJ1dHRvbnNEaXYsICLkuIvovb3lhajpg6jlm77niYcgKCIgKyBpbWdzLmxlbmd0aCArICIpIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkSW1hZ2VzKGltZ3MsIGdldFByZWZpeEZyb21BcnRpY2xlKGFydGljbGUpKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgKQogICAgfQoKICAgIGZ1bmN0aW9uIGluamVjdE9uZUJ1dHRvbigKICAgICAgICBlbGVtZW50LAogICAgICAgIHRleHRPbkJ1dHRvbiwKICAgICAgICBjbGlja0xpc3RlbmVyLAogICAgICAgIGV4dHJhU3R5bGUgPSAiIgogICAgKSB7CiAgICAgICAgdmFyIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIkJVVFRPTiIpOwogICAgICAgIHZhciBidG5UZXh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGV4dE9uQnV0dG9uKTsKICAgICAgICBidG4uYXBwZW5kQ2hpbGQoYnRuVGV4dCk7CiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgY2xpY2tMaXN0ZW5lcik7CiAgICAgICAgYnRuLnN0eWxlID0KICAgICAgICAgICAgImJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyBib3JkZXI6IHNvbGlkICM4MDgwODAgMnB4OyBib3JkZXItcmFkaXVzOiAyMHB4OyBjb2xvcjogIzU0NTQ1NDsgbWFyZ2luOiAwLjJlbTsiICsKICAgICAgICAgICAgZXh0cmFTdHlsZTsKICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGJ0bik7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0QnV0dG9uRGl2KCkgewogICAgICAgIHZhciBidXR0b25zRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgYnV0dG9uc0Rpdi5jbGFzc05hbWUgPSAibGRoLW1vLWRsIjsKICAgICAgICBidXR0b25zRGl2LnN0eWxlID0gIm1hcmdpbi10b3A6IDAuNGVtOyBtYXJnaW4tYm90dG9tOiAwLjRlbSI7CiAgICAgICAgcmV0dXJuIGJ1dHRvbnNEaXY7CiAgICB9CgogICAgZnVuY3Rpb24gZ2VuZXJhdGVPbkNsaWNrSGFuZGxlcihidXR0b25zRGl2LCBpbWdzKSB7CiAgICAgICAgdmFyIHRleHRhcmVhID0gYnV0dG9uc0Rpdi5xdWVyeVNlbGVjdG9yKCJ0ZXh0YXJlYS5sZGgtbW8tZGwiKTsKICAgICAgICBpZiAoIXRleHRhcmVhKSB7CiAgICAgICAgICAgIHRleHRhcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGV4dGFyZWEiKTsKICAgICAgICAgICAgdGV4dGFyZWEuY2xhc3NOYW1lID0gImxkaC1tby1kbCI7CiAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlID0gImhlaWdodDogMTAwcHg7IHdpZHRoOiA4MCU7IjsKICAgICAgICAgICAgdmFyIGJyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnIiKTsKICAgICAgICAgICAgYnV0dG9uc0Rpdi5pbnNlcnRCZWZvcmUoYnIsIGJ1dHRvbnNEaXYuZmlyc3RDaGlsZCk7CiAgICAgICAgICAgIGJ1dHRvbnNEaXYuaW5zZXJ0QmVmb3JlKHRleHRhcmVhLCBidXR0b25zRGl2LmZpcnN0Q2hpbGQpOwogICAgICAgIH0KICAgICAgICB0ZXh0YXJlYS52YWx1ZSA9IGltZ3Muam9pbigiXG4iKTsKICAgICAgICB0ZXh0YXJlYS5zZWxlY3QoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjdXN0b21pemVkVGltZWxpbmVQYWdlKCkgewogICAgICAgIC8vIOWIneWni+WMlgogICAgICAgIGRvY3VtZW50CiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKCJsZGgtaW5maW5pdGUtc2Nyb2xsIGFydGljbGUiKQogICAgICAgICAgICAuZm9yRWFjaCgoYXJ0aWNsZSkgPT4gYXR0YWNoQnV0dG9uVG9BcnRpY2xlKGFydGljbGUpKTsKICAgICAgICBkb2N1bWVudAogICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbCgibGRoLWluZmluaXRlLXNjcm9sbCBsZGgtaW1hZ2VkaWFyeS10aW1lbGluZS1saXN0LWl0ZW0iKQogICAgICAgICAgICAuZm9yRWFjaCgoYXJ0aWNsZSkgPT4gYXR0YWNoQnV0dG9uVG9BcnRpY2xlKGFydGljbGUpKTsKICAgICAgICBjb25zdCBpbmZpbml0ZVNjcm9sbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoCiAgICAgICAgICAgICJsZGgtaW5maW5pdGUtc2Nyb2xsIgogICAgICAgICk7CiAgICAgICAgY29uc3QgY29uZmlnID0geyBjaGlsZExpc3Q6IHRydWUgfTsKICAgICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uIChtdXRhdGlvbnMsIG9ic2VydmVyKSB7CiAgICAgICAgICAgIHZhciBub2RlcyA9IG11dGF0aW9ucy5maW5kKChyKSA9PgogICAgICAgICAgICAgICAgQXJyYXkuZnJvbShyLmFkZGVkTm9kZXMpLmZpbHRlcigKICAgICAgICAgICAgICAgICAgICAobikgPT4KICAgICAgICAgICAgICAgICAgICAgICAgbi5jbGFzc05hbWUgPT0gImFydGljbGUiIHx8CiAgICAgICAgICAgICAgICAgICAgICAgIG4uY2xhc3NOYW1lID09ICJsZGgtaW1hZ2VkaWFyeS10aW1lbGluZS1saXN0LWl0ZW0iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkuYWRkZWROb2RlczsKICAgICAgICAgICAgbm9kZXMuZm9yRWFjaCgobm9kZSkgPT4KICAgICAgICAgICAgICAgIGF0dGFjaEJ1dHRvblRvQXJ0aWNsZSgKICAgICAgICAgICAgICAgICAgICBub2RlLnF1ZXJ5U2VsZWN0b3IoImFydGljbGUiKSB8fAogICAgICAgICAgICAgICAgICAgIG5vZGUucXVlcnlTZWxlY3RvcigibGRoLWltYWdlZGlhcnktdGltZWxpbmUtbGlzdC1pdGVtIikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmVtb3ZlUHJvdGVjdEltZygpOwogICAgICAgICAgICBtb0Rvd25sb2FkZXJEZWJ1Zygi6Kej6Zmk5Yi35paw5ZCO5pe26Ze057q/5Y+z6ZSu6ZmQ5Yi2Iik7CiAgICAgICAgfSk7CiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShpbmZpbml0ZVNjcm9sbENvbnRhaW5lciwgY29uZmlnKTsKICAgICAgICBtb0Rvd25sb2FkZXJMb2coIlRpbWVsaW5l6aG16Z2i5rOo5YWl5oyJ6ZKuIik7CiAgICB9CgogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyA9ICAgIERvd25sb2FkIFV0aWxzICAgID0KICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIGZ1bmN0aW9uIGRvd25sb2FkSW1hZ2VzKGltZ3MsIHByZWZpeCA9ICIiKSB7CiAgICAgICAgbW9Eb3dubG9hZGVyRGVidWcoIuato+WcqOS4i+i9veWbvueJh++8miAiICsgaW1ncyk7CiAgICAgICAgLy8gVGhhbmtzIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS95MjUyMzI4L0luc3RhZ3JhbV9Eb3dubG9hZF9CdXR0b24KICAgICAgICBpZiAoaW1ncy5sZW5ndGggPD0gMTApIHsKICAgICAgICAgICAgLy8g5ZCM5pe25pyA5aSa5LiL6L295Y2B5byg5Zu+CiAgICAgICAgICAgIGltZ3MubWFwKChpbWcpID0+IGRvd25sb2FkT25lSW1hZ2UoaW1nLCBwcmVmaXgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDorr7nva7lu7bml7bkuIvovb3mm7TlpJrlm77niYcgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTYyNDQ5MDIvNTYyNDU2MTAjNTYyNDU2MTAKICAgICAgICAgICAgaW1ncy5mb3JFYWNoKChpbWcsIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZE9uZUltYWdlKGltZywgcHJlZml4KTsKICAgICAgICAgICAgICAgIH0sIGluZGV4ICogMjAwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGRvd25sb2FkT25lSW1hZ2UoaW1nLCBwcmVmaXggPSAiIikgewogICAgICAgIGZldGNoKGltZywgewogICAgICAgICAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh7CiAgICAgICAgICAgICAgICBPcmlnaW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBtb2RlOiAiY29ycyIsCiAgICAgICAgICAgIGNhY2hlOiAibm8tY2FjaGUiLAogICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuYmxvYigpKQogICAgICAgICAgICAudGhlbigoYmxvYikgPT4KICAgICAgICAgICAgICAgIGRvd2xvYWRCbG9iKAogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpLAogICAgICAgICAgICAgICAgICAgIHByZWZpeCArIGltZy5zdWJzdHJpbmcoaW1nLmxhc3RJbmRleE9mKCIvIikgKyAxKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gY29uc29sZS5lcnJvcihlKSk7CiAgICB9CgogICAgZnVuY3Rpb24gZG93bmxvYWRWaWRlbyhidXR0b24sIHZpZGVvLCBwcmVmaXggPSAiIikgewogICAgICAgIGNvbnN0IHZpZGVvUmVxdWVzdFVSTCA9CiAgICAgICAgICAgICJodHRwczovL3Byb2R1Y3Rpb24tcHMubHZwLmxsbncubmV0L3IvUGxheWxpc3RTZXJ2aWNlL21lZGlhLzxtZWRpYUlkPi9nZXRNb2JpbGVQbGF5bGlzdEJ5TWVkaWFJZCI7CiAgICAgICAgZmV0Y2godmlkZW9SZXF1ZXN0VVJMLnJlcGxhY2UoIjxtZWRpYUlkPiIsIHZpZGVvKSwgewogICAgICAgICAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh7CiAgICAgICAgICAgICAgICBPcmlnaW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sCiAgICAgICAgICAgICAgICBSZWZlcmVyOiB3aW5kb3cubG9jYXRpb24ub3JpZ2luLAogICAgICAgICAgICB9KSwKICAgICAgICAgICAgbW9kZTogImNvcnMiLAogICAgICAgICAgICBjYWNoZTogIm5vLWNhY2hlIiwKICAgICAgICB9KQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHJlc3BvbnNlLmpzb24oKSkKICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICAvLyDkuLttM3U4CiAgICAgICAgICAgICAgICBsZXQgbTN1OFVybCA9IHJlc3BvbnNlLm1lZGlhTGlzdFswXS5tb2JpbGVVcmxzCiAgICAgICAgICAgICAgICAgICAgLmZpbmQoKHYpID0+IHYudGFyZ2V0TWVkaWFQbGF0Zm9ybSA9PSAiSHR0cExpdmVTdHJlYW1pbmciKQogICAgICAgICAgICAgICAgICAgIC5tb2JpbGVVcmwucmVwbGFjZSgiaHR0cDovLyIsICJodHRwczovLyIpOwogICAgICAgICAgICAgICAgZmV0Y2gobTN1OFVybCkKICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHJlc3BvbnNlLnRleHQoKSkKICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8g6I635Y+WbTN1OOS4reacgOmrmOa4heeahAogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiYW5kd2l0aFJlID0gL0JBTkRXSURUSD0oXGQrKS9pOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxpZ2libGVTdHJlYW1zUmF3ID0gcmVzcG9uc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgiI0VYVC1YLVNUUkVBTS1JTkY6IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zbGljZSgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZ2libGVTdHJlYW1zUmF3LnNvcnQoKGEsIGIpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoYi5tYXRjaChiYW5kd2l0aFJlKVsxXSkgLQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KGEubWF0Y2goYmFuZHdpdGhSZSlbMV0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbmRpZGF0ZSA9IGVsaWdpYmxlU3RyZWFtc1Jhd1swXS5zcGxpdCgiXG4iKVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVUkwoY2FuZGlkYXRlLCBuZXcgVVJMKG0zdThVcmwpLm9yaWdpbikuaHJlZjsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC50aGVuKChtM3U4VXJsKSA9PgogICAgICAgICAgICAgICAgICAgICAgICBvcGVuTTNVOFRvb2xCb3goCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtM3U4VXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZml4ICsgZ2V0RmlsZW5hbWVGcm9tVmlkZW9VcmwobTN1OFVybCkKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGRvd2xvYWRCbG9iKGJsb2IsIGZpbGVuYW1lKSB7CiAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgYS5kb3dubG9hZCA9IGZpbGVuYW1lOwogICAgICAgIGEuaHJlZiA9IGJsb2I7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsKICAgICAgICBhLmNsaWNrKCk7CiAgICAgICAgYS5yZW1vdmUoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcGVuTTNVOFRvb2xCb3goYnV0dG9uLCBtM3U4VXJsLCBmaWxlbmFtZSkgewogICAgICAgIC8vIOaJk+W8gCBodHRwczovL3Rvb2xzLnRoYXR3aW5kLmNvbS90b29sL20zdThkb3dubG9hZGVyCiAgICAgICAgaWYgKGlzTW9iaWxlKCkpIHsKICAgICAgICAgICAgbGV0IGlkID0gYnRvYShlbmNvZGVVUklDb21wb25lbnQoZmlsZW5hbWUpKTsKICAgICAgICAgICAgdmFyIGEgPSBidXR0b24ucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCJhLm1vLWRvd25sb2FkZXIiKTsKICAgICAgICAgICAgaWYgKCFhKSB7CiAgICAgICAgICAgICAgICBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgICAgICAgICAgdmFyIGFUZXh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIueCueWHu+aJk+W8gOS4i+i9vemhtemdoiIpOwogICAgICAgICAgICAgICAgYS5jbGFzc05hbWUgPSAibW8tZG93bmxvYWRlciI7CiAgICAgICAgICAgICAgICBhLmFwcGVuZChhVGV4dCk7CiAgICAgICAgICAgICAgICBhLnRhcmdldCA9ICJfYmxhbmsiOwogICAgICAgICAgICAgICAgYS5ocmVmID0gY29uc3RydWN0TTNVOFRvb2xCb3hVUkwobTN1OFVybCwgZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgYnV0dG9uLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnIiKSk7CiAgICAgICAgICAgICAgICBidXR0b24ucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChhKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgIGEudGFyZ2V0ID0gIl9ibGFuayI7CiAgICAgICAgICAgIGEuaHJlZiA9IGNvbnN0cnVjdE0zVThUb29sQm94VVJMKG0zdThVcmwsIGZpbGVuYW1lKTsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsKICAgICAgICAgICAgYS5jbGljaygpOwogICAgICAgICAgICBhLnJlbW92ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjb25zdHJ1Y3RNM1U4VG9vbEJveFVSTChtM3U4VXJsLCBmaWxlbmFtZSkgewogICAgICAgIHZhciB1cmwgPQogICAgICAgICAgICAiaHR0cHM6Ly90b29scy50aGF0d2luZC5jb20vdG9vbC9tM3U4ZG93bmxvYWRlciMiICsKICAgICAgICAgICAgIm0zdTg9IiArCiAgICAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChtM3U4VXJsKSArCiAgICAgICAgICAgICImcmVmZXJlcj0iICsKICAgICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5ocmVmKSArCiAgICAgICAgICAgICImZmlsZW5hbWU9IiArCiAgICAgICAgICAgIGZpbGVuYW1lOwogICAgICAgIG1vRG93bmxvYWRlckRlYnVnKHVybCk7CiAgICAgICAgcmV0dXJuIHVybDsKICAgIH0KCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyA9ICAgIE5hbWluZyBVdGlscyAgICA9CiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09CgogICAgZnVuY3Rpb24gZ2V0UHJlZml4RnJvbUFydGljbGUoYXJ0aWNsZSkgewogICAgICAgIHZhciBjYW5kaWRhdGUgPQogICAgICAgICAgICBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoIi5hcnRpY2xlX19oZWFkIikgfHwKICAgICAgICAgICAgYXJ0aWNsZS5xdWVyeVNlbGVjdG9yKCIuYXJ0aWNsZV9faGVhZGVyIikgfHwKICAgICAgICAgICAgYXJ0aWNsZS5xdWVyeVNlbGVjdG9yKCIucC1kZXRhaWxfYXJ0aWNsZV9faGVhZGVyLXRleHQiKTsKICAgICAgICBpZiAoY2FuZGlkYXRlKSB7CiAgICAgICAgICAgIHJldHVybiBzYW5pdGl6ZUZpbGVOYW1lKAogICAgICAgICAgICAgICAgY2FuZGlkYXRlLnRleHRDb250ZW50CiAgICAgICAgICAgICAgICAgICAgLnNwbGl0KC9ccy9nKQogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKHMpID0+IHMpCiAgICAgICAgICAgICAgICAgICAgLmpvaW4oIl8iKSArICJfIgogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZ2V0UHJlZml4RnJvbURvY3VtZW50KCk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UHJlZml4RnJvbURvY3VtZW50KCkgewogICAgICAgIC8vIOWmguaenOWtmOWcqO+8jOS9v+eUqG1vdmll5qCH6aKYCiAgICAgICAgdmFyIGNhbmRpZGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5tb3ZpZS10aXRsZS1ibG9jayIpOwogICAgICAgIGlmIChjYW5kaWRhdGUpIHsKICAgICAgICAgICAgcmV0dXJuIHNhbml0aXplRmlsZU5hbWUoCiAgICAgICAgICAgICAgICBjYW5kaWRhdGUudGV4dENvbnRlbnQKICAgICAgICAgICAgICAgICAgICAuc3BsaXQoL1xzL2cpCiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigocykgPT4gcykKICAgICAgICAgICAgICAgICAgICAuam9pbigiXyIpICsgIl8iCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzYW5pdGl6ZUZpbGVOYW1lKGRvY3VtZW50LnRpdGxlLnNwbGl0KCJ8IilbMF0gKyAiXyIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEZpbGVuYW1lRnJvbVZpZGVvVXJsKHVybCkgewogICAgICAgIGxldCB0ZW1wTmFtZSA9IHVybC5yZXBsYWNlKCIvcm9vdC1tZXNzYWdlLWN4Zi1hcGFjaGUiLCAiIik7CiAgICAgICAgdGVtcE5hbWUgPSB0ZW1wTmFtZQogICAgICAgICAgICAuc3Vic3RyaW5nKHRlbXBOYW1lLmxhc3RJbmRleE9mKCIvIikgKyAxKQogICAgICAgICAgICAucmVwbGFjZSgiLm0zdTgiLCAiLnRzIik7CiAgICAgICAgcmV0dXJuIHRlbXBOYW1lOwogICAgfQoKICAgIGZ1bmN0aW9uIHNhbml0aXplRmlsZU5hbWUoaW5wdXQsIHJlcGxhY2VtZW50ID0gIl8iKSB7CiAgICAgICAgLy8gVGhhbmtzIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9wYXJzaGFwL25vZGUtc2FuaXRpemUtZmlsZW5hbWUvYmxvYi9tYXN0ZXIvaW5kZXguanMKICAgICAgICBjb25zdCBpbGxlZ2FsUmUgPSAvW1wvXD88PlxcOlwqXHwiXS9nOwogICAgICAgIGNvbnN0IGNvbnRyb2xSZSA9IC9bXHgwMC1ceDFmXHg4MC1ceDlmXS9nOwogICAgICAgIGNvbnN0IHJlc2VydmVkUmUgPSAvXlwuKyQvOwogICAgICAgIGNvbnN0IHdpbmRvd3NSZXNlcnZlZFJlID0gL14oY29ufHBybnxhdXh8bnVsfGNvbVswLTldfGxwdFswLTldKShcLi4qKT8kL2k7CiAgICAgICAgY29uc3Qgd2luZG93c1RyYWlsaW5nUmUgPSAvW1wuIF0rJC87CiAgICAgICAgcmV0dXJuIGlucHV0CiAgICAgICAgICAgIC5yZXBsYWNlKGlsbGVnYWxSZSwgcmVwbGFjZW1lbnQpCiAgICAgICAgICAgIC5yZXBsYWNlKGNvbnRyb2xSZSwgcmVwbGFjZW1lbnQpCiAgICAgICAgICAgIC5yZXBsYWNlKHJlc2VydmVkUmUsIHJlcGxhY2VtZW50KQogICAgICAgICAgICAucmVwbGFjZSh3aW5kb3dzUmVzZXJ2ZWRSZSwgcmVwbGFjZW1lbnQpCiAgICAgICAgICAgIC5yZXBsYWNlKHdpbmRvd3NUcmFpbGluZ1JlLCByZXBsYWNlbWVudCk7CiAgICB9CgogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vID0gICAgTG9nZ2luZyBVdGlscyAgICA9CiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PQoKICAgIGZ1bmN0aW9uIG1vRG93bmxvYWRlckxvZyhtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygiW21vLWRvd25sb2Rlcl0gIiArIG1zZyk7CiAgICB9CgogICAgZnVuY3Rpb24gbW9Eb3dubG9hZGVyRGVidWcobXNnKSB7CiAgICAgICAgY29uc29sZS5kZWJ1ZygiW21vLWRvd25sb2Rlcl0gIiArIG1zZyk7CiAgICB9Cn0pKCk7Cg=="
}